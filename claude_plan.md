# 통계 화면 개선 (그래프, 추이 분석) - 구현 계획

## 📋 현황 분석

### 기존 기능 (1410줄)
✅ 완료율 원형 차트 (Pie Chart)
✅ 주간 막대 차트 (Bar Chart) - 일별 완료 현황
✅ 월간 라인 차트 (Line Chart) - 4주간 추이
✅ 스트릭 카운터, 베스트 데이
✅ 일일 통계, 시간 분석
✅ 다크모드, 다국화 지원

### 개선 필요 영역
❌ 카테고리별 통계 그래프 부재
❌ 월간/연간 장기 추이 분석 부재
❌ 생산성 지표 (완료 속도, 효율성) 부재
❌ 요일별 패턴 분석 시각화 부재
❌ 타임 히트맵 (시간대별 완료 분포) 부재
❌ 데이터 필터링 옵션 부재

---

## 🎯 3단계 개선 계획

### **Phase 1: 카테고리별 분석 추가** (30분)
**목표**: 카테고리별 완료율 시각화

**구현 내용**:
1. `_StatisticsData` 모델에 카테고리 통계 추가
   - `categoryStats`: Map<String, CategoryStat> (카테고리명 → 통계)
   - `CategoryStat`: 총 개수, 완료 개수, 완료율

2. 카테고리별 통계 계산 로직 추가
   - `_calculateCategoryStatistics()` 메서드
   - 각 카테고리의 완료율 계산

3. 새로운 카드 추가: `_CategoryAnalysisCard`
   - 가로 막대 차트로 카테고리별 완료율 비교
   - 카테고리별 색상 구분
   - 토탈 수 표시

**수정 파일**:
- `statistics_screen.dart` (약 +150줄)

**사용 라이브러리**: 기존 fl_chart 활용

---

### **Phase 2: 장기 추이 분석** (30분)
**목표**: 월간/연간 패턴 분석 추가

**구현 내용**:
1. 월간 통계 확장
   - 기존: 4주 (최근 한 달)
   - 추가: 12개월 데이터 (연간 추이)

2. 새로운 카드: `_MonthlyAnalysisCard`
   - 월별 완료 수 라인 차트
   - 평균선 표시 (전체 평균과 비교)
   - 최고/최저 달 강조

3. 생산성 지표 추가
   - 월간 평균 완료 수
   - 최고 생산성 월
   - 추이 방향 (↑/↓/→)

**수정 파일**:
- `statistics_screen.dart` (약 +120줄)

**사용 라이브러리**: 기존 fl_chart 활용

---

### **Phase 3: 고급 분석 및 인사이트** (30분)
**목표**: 사용자 패턴 분석 및 추천

**구현 내용**:
1. 요일별 패턴 분석
   - 새로운 카드: `_WeeklyPatternCard`
   - 각 요일별 평균 완료 수 표시
   - 최고 생산성 요일 강조
   - 선택 가능한 필터 (이번주/지난주/전체)

2. 타임 히트맵 (선택사항)
   - 시간대별 완료 분포 (24시간)
   - 히트맵으로 시각화
   - 최고 활동 시간대 표시

3. 인사이트 섹션
   - 새로운 카드: `_InsightsCard`
   - 자동 생성되는 분석 문구:
     - "월요일에 가장 생산적입니다 💪"
     - "평균 3.2시간 내에 작업을 완료합니다 ⏱️"
     - "지난달 대비 15% 향상했습니다 📈"
     - "최고 기록: 한 날에 12개 완료 🔥"

**수정 파일**:
- `statistics_screen.dart` (약 +200줄)

**새로운 가능 의존성**: 선택사항 (현재 라이브러리로 구현 가능)

---

## 📊 최종 결과

### 코드 구조
```
StatisticsScreen (메인 화면)
├── _OverallProgressCard (기존 ✅)
├── _StreakCard (기존 ✅)
├── _WeeklyBarChartCard (기존 ✅)
├── _MonthlyLineChartCard (기존 ✅)
├── _CategoryAnalysisCard (NEW 📊)
├── _TodayStatisticsCard (기존 ✅)
├── _MonthlyAnalysisCard (NEW 📈)
├── _WeeklyPatternCard (NEW 🎯)
├── _InsightsCard (NEW 💡)
└── _TimeBasedStatisticsCard (기존 ✅)
```

### 총 변경사항
- **파일**: `statistics_screen.dart` 1개만 수정
- **라인 수**: +470줄 추가 (총 약 1880줄)
- **새 카드**: 4개 추가
- **새 메서드**: 3-4개 추가
- **의존성**: 변경 없음 (기존 fl_chart 활용)

### 테스트 포인트
✅ 카테고리 통계 정확성 (카테고리 없는 경우 포함)
✅ 장기 데이터 계산 성능 (큰 데이터셋)
✅ 다크모드 색상 호환성
✅ 다국화 문자열 (새 텍스트 추가)
✅ 타임라인 데이터 정합성

---

## 🚀 구현 순서

1. **Phase 1 (카테고리 분석)** - 30분
   - 가장 요청도 높은 기능
   - 빠른 구현 가능

2. **Phase 2 (장기 추이)** - 30분
   - Phase 1 기반으로 자연스러운 확장
   - 인덱싱 효율적

3. **Phase 3 (고급 분석)** - 30분
   - 사용자 경험 향상
   - AI 인사이트 제공

---

## ⚠️ 주의사항

1. **성능**: 많은 카테고리가 있을 경우 차트 성능 저하 가능
   - 해결: 카테고리 > 5개일 때 상위 5개 + "기타" 그룹화

2. **메모리**: 월간 데이터 12개월 계산 필요
   - 해결: 캐싱 고려 (필요시)

3. **UI 스크롤**: 카드 추가로 화면 길이 증가
   - 해결: 기존 스크롤 구조 유지하면 자동 해결

4. **다국화**: 새로운 문자열 추가
   - 필요한 키: 아래 참조
